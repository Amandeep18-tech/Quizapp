{% load static %}
{% load mathfilters %}
{% load crispy_forms_tags%}
<!DOCTYPE html>

<head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  
      <link rel="stylesheet" type="text/css" href="{% static 'main.css' %}">
    <title>
        Django Online quiz App
    </title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <style>
        .btn-primary{
            width: 10%;
        }
        .btn-success{
            width: 10%;
        }
        <!--
        /* @group Blink */
        .blink {
            -webkit-animation: blink .75s linear infinite;
            -moz-animation: blink .75s linear infinite;
            -ms-animation: blink .75s linear infinite;
            -o-animation: blink .75s linear infinite;
            animation: blink .75s linear infinite;
        }

        @-webkit-keyframes blink {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 1;
            }

            50.01% {
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }

        @-moz-keyframes blink {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 1;
            }

            50.01% {
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }

        @-ms-keyframes blink {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 1;
            }

            50.01% {
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }

        @-o-keyframes blink {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 1;
            }

            50.01% {
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }

        @keyframes blink {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 1;
            }

            50.01% {
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }
        

        /* @end */
        -->
    </style>


</head>

<body>
    <header class="site-header">
      <nav class="navbar navbar-expand-md navbar-dark bg-steel fixed-top">
        <div class="container">
          <a class="navbar-brand mr-4" >Django Quiz</a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggle" aria-controls="navbarToggle" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarToggle">
            <div class="navbar-nav mr-auto">
              <a class="nav-item nav-link" href="{% url 'question-page' %}" >Home</a>
              <a class="nav-item nav-link" href="{% url 'profile'%}" >Profile</a>
            </div>
            <!-- Navbar Right Side -->
            <div class="navbar-nav">
                {% if user.is_authenticated %}
                
                    <a class="nav-item nav-link" href="{% url 'logout' %}">Logout</a>
                {% else %}
                    <a class="nav-item nav-link" href="{% url 'login' %}">Login</a>
                    <a class="nav-item nav-link" href="{% url 'register' %}">Register</a>
              {% endif %}
            </div>
          </div>
        </div>
      </nav>
    </header>
    <main role="main" class="container">
      <div class="row">
        <div class="col-md-8">
            {% if messages%}
                {% for message in messages%}
                    <div class="alert alert-{{message.tags}}">
                        {{message}}
                    </div>
                {% endfor %}
            {% endif %}
          
        </div>
        
      </div>
    </main>
    <center>
    
        <h1>Welcome to the quiz app {{user.username}}</h1>
        
        <hr>
        </hr>
    </center>

    </h6>
    <div style="padding-left: 60px;">
        
           
        
        {%for result in questions %}
        <div class="container">
            <div class="progress">
                <div class="progress-bar progress-bar-striped active" role="progressbar" 
                id="pg" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width:
                {% with current_page=result.id|mul:100 %}
                {{ current_page|div:total_pages}}%"></div>
                {% endwith %}
                </div>
            </div>
            <p id="countdown_1" style="position: relative; left:1150px; padding: 0%;"></p>
             
        <hr>

            <form method="POST" id="myform">
                {% csrf_token %} 
                        {{result.id}} ) {{result.Question}}
                    </br>
                    <input type="radio" id=Option1 value="{{result.Option1}}" class="rb"
                        name="name"> {{result.Option1}}<br>
                    <input type="radio" id=Option2 value="{{result.Option2}}" class="rb"
                        name="name"> {{result.Option2}}<br>
                    <input type="radio" id=Option3 value="{{result.Option3}}" class="rb"
                        name="name"> {{result.Option3}} <br>               
                    <input type="radio" id=Option4 value="{{result.Option4}}" class="rb"
                        name="name"> {{result.Option4}}<br>
                    <label id="correct_ans" class="rb" style="display: none; color: green;"><b>The Correct answer is:
                    {{result.Correct_ans}}</b></label>      
        </hr>
        <input type="hidden" name="question_id" value="{{result.id}}">
        {% endfor %}

        <input type="text" name="answer" id="value"  />
    </form>
        <br>
       <b id="UserAnswers"></b>
       <div class="paginetor">
            <div class="form-group">
                {%  if questions.has_next %}
                    <a href="?page={{ questions.next_page_number }}"><button type="submit" 
                        class="btn form-control btn-primary" id="submitAnswer">Next</button></a>
                {% else %}
                    <a href="{% url 'result-page' %}"><button 
                        class="btn form-control btn-success" id="submitAnswer" >Submit Quiz</button></a>  
                        {% endif %} 
                </div>
            </div>  
    </div>
    
       
    <script>
        $(document).ready(function(){
            $("#button1").click(function () {
                $(".rb").get();
                $(".rb").attr("disabled", true);
            });
        });
        function getAnswers() {
            document.getElementById("UserAnswers").innerHTML = "";
            var e = document.getElementsByTagName('Input');
            for (i = 0; i < e.length; i++) {
                if (e[i].type == "radio") {
                    if (e[i].checked) {
                        document.getElementById("UserAnswers").innerHTML += "Q" + e[i].name + ")." + 
                        "The answer you have selected is:" + e[i].value + "</br>";
                       
                        
                    }
                }

            }
        }
        n = {{Exam.count}};
        const starting_time = 1;
        let time = starting_time * 60;
        const countdownel = document.getElementById('countdown_1');
        function updatecountdown() {
            const minutes = Math.floor(time / 60);
            let seconds = time % 60;

            if (minutes < 0) {
                document.getElementById("button1").disabled = true;
                countdownel.innerHTML = 'Timer over';
                return;
            }
            seconds = seconds < 10 ? '0' + seconds : seconds;
            countdownel.innerHTML = `${minutes}: ${seconds}`;
            time--;

        }
        setInterval(updatecountdown, 1000);
        $(document).ready(function()
    {
        $('.rb').click(function(){
            var txt="";
            $('.rb:checked').each(function()
            {
                txt+=$(this).val
            });
            $('#answer').val(txt);
        }
        );
    }
    );
    </script>
    <script src="{% static 'script.js' %}">
                </script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>